{"version":3,"file":"tokenController.js","sources":["src/controllers/tokenController.ts"],"sourceRoot":"/","sourcesContent":["import type { AuthenticatedRequest } from \"../middleware/authMiddleware.js\";\r\nimport type { Request, Response } from \"express\";\r\nimport prisma from \"../lib/prisma.js\";\r\nimport { v4 as uuidv4 } from \"uuid\";\r\nimport { sendPasswordResetEmail } from \"../lib/mail.js\";\r\n\r\nexport async function saveFCMToken(req: AuthenticatedRequest, res: Response) {\r\n  const userId = req.user?.id; // assuming verifyToken middleware sets req.user\r\n  const { token } = req.body;\r\n\r\n  if (!userId) {\r\n    return res\r\n      .status(401)\r\n      .json({ success: false, error: \"No authenticated user\" });\r\n  }\r\n  if (!token) {\r\n    return res.status(400).json({ success: false, error: \"No token provided\" });\r\n  }\r\n\r\n  try {\r\n    await prisma.fCMToken.deleteMany({ where: { userId } });\r\n    await prisma.fCMToken.create({\r\n      data: {\r\n        token,\r\n        userId,\r\n        platform: \"web\",\r\n        lastUsedAt: new Date(),\r\n        isValid: true,\r\n      },\r\n    });\r\n    return res.json({ success: true });\r\n  } catch (error) {\r\n    console.error(\"Error saving FCM token:\", error);\r\n    return res\r\n      .status(500)\r\n      .json({ success: false, error: \"Failed to save FCM token\" });\r\n  }\r\n}\r\n\r\n/**\r\n * POST /api/tokens/password-reset\r\n * Request password reset email by providing an email address\r\n */\r\nexport async function requestPasswordReset(req: Request, res: Response) {\r\n  try {\r\n    const { email } = req.body;\r\n\r\n    if (!email) {\r\n      console.warn(\"❌ Password reset request: Missing email\");\r\n      return res.status(400).json({ error: \"Email is required\" });\r\n    }\r\n\r\n    // Check if user exists\r\n    const user = await prisma.user.findUnique({\r\n      where: { email },\r\n    });\r\n\r\n    if (!user) {\r\n      console.warn(\r\n        `❌ Password reset request: User not found for email: ${email}`\r\n      );\r\n      // Don't reveal if email exists or not (security best practice)\r\n      return res.status(200).json({\r\n        success: true,\r\n        message:\r\n          \"If an account exists with this email, a reset link will be sent.\",\r\n      });\r\n    }\r\n\r\n    // Delete any existing tokens for this email\r\n    const existingToken = await prisma.passwordResetToken.findFirst({\r\n      where: { email },\r\n    });\r\n\r\n    if (existingToken) {\r\n      await prisma.passwordResetToken.delete({\r\n        where: { id: existingToken.id },\r\n      });\r\n    }\r\n\r\n    // Generate new reset token\r\n    const resetToken = uuidv4();\r\n    const expiresAt = new Date(Date.now() + 24 * 60 * 60 * 1000); // 24 hours\r\n\r\n    const passwordResetToken = await prisma.passwordResetToken.create({\r\n      data: {\r\n        email,\r\n        token: resetToken,\r\n        expiration: expiresAt,\r\n      },\r\n    });\r\n\r\n    // Send reset email\r\n    try {\r\n      await sendPasswordResetEmail(email, resetToken);\r\n    } catch (emailError) {\r\n      console.error(\r\n        `❌ Failed to send password reset email to ${email}:`,\r\n        emailError\r\n      );\r\n      // Delete the token if email fails to send\r\n      await prisma.passwordResetToken.delete({\r\n        where: { id: passwordResetToken.id },\r\n      });\r\n      return res.status(500).json({\r\n        error: \"Failed to send reset email. Please try again.\",\r\n      });\r\n    }\r\n\r\n    return res.status(200).json({\r\n      success: true,\r\n      message:\r\n        \"If an account exists with this email, a reset link will be sent.\",\r\n    });\r\n  } catch (error) {\r\n    console.error(\"❌ Error in requestPasswordReset:\", error);\r\n    return res.status(500).json({ error: \"Internal server error\" });\r\n  }\r\n}\r\n\r\n/**\r\n * POST /api/tokens/reset-password\r\n * Reset user password using the reset token\r\n */\r\nexport async function resetPassword(req: Request, res: Response) {\r\n  try {\r\n    const { token, password } = req.body;\r\n\r\n    if (!token || !password) {\r\n      console.warn(\"❌ Reset password: Missing token or password\");\r\n      return res.status(400).json({ error: \"Token and password are required\" });\r\n    }\r\n\r\n    if (password.length < 6) {\r\n      return res\r\n        .status(400)\r\n        .json({ error: \"Password must be at least 6 characters\" });\r\n    }\r\n\r\n    // Find and validate token\r\n    const resetTokenRecord = await prisma.passwordResetToken.findUnique({\r\n      where: { token },\r\n    });\r\n\r\n    if (!resetTokenRecord) {\r\n      console.warn(`❌ Invalid password reset token: ${token}`);\r\n      return res.status(400).json({ error: \"Invalid or expired reset token\" });\r\n    }\r\n\r\n    // Check if token is expired\r\n    if (resetTokenRecord.expiration < new Date()) {\r\n      console.warn(\r\n        `❌ Password reset token expired for: ${resetTokenRecord.email}`\r\n      );\r\n      // Delete expired token\r\n      await prisma.passwordResetToken.delete({\r\n        where: { id: resetTokenRecord.id },\r\n      });\r\n      return res.status(400).json({ error: \"Reset token has expired\" });\r\n    }\r\n\r\n    // Find user\r\n    const user = await prisma.user.findUnique({\r\n      where: { email: resetTokenRecord.email },\r\n    });\r\n\r\n    if (!user) {\r\n      console.warn(`❌ User not found for email: ${resetTokenRecord.email}`);\r\n      return res.status(400).json({ error: \"User not found\" });\r\n    }\r\n\r\n    await prisma.user.update({\r\n      where: { id: user.id },\r\n      data: { password }, // ⚠️ TODO: Hash password before storing\r\n    });\r\n\r\n    // Delete used token\r\n    await prisma.passwordResetToken.delete({\r\n      where: { id: resetTokenRecord.id },\r\n    });\r\n\r\n    return res.status(200).json({\r\n      success: true,\r\n      message:\r\n        \"Password reset successfully. Please sign in with your new password.\",\r\n    });\r\n  } catch (error) {\r\n    console.error(\"❌ Error in resetPassword:\", error);\r\n    return res.status(500).json({ error: \"Internal server error\" });\r\n  }\r\n}\r\n\r\n/**\r\n * GET /api/tokens/verify-reset-token/:token\r\n * Verify if a reset token is valid\r\n */\r\nexport async function verifyResetToken(req: Request, res: Response) {\r\n  try {\r\n    const { token } = req.params;\r\n\r\n    if (!token) {\r\n      return res.status(400).json({ error: \"Token is required\" });\r\n    }\r\n\r\n    const resetTokenRecord = await prisma.passwordResetToken.findUnique({\r\n      where: { token },\r\n    });\r\n\r\n    if (!resetTokenRecord) {\r\n      console.warn(`❌ Invalid token: ${token}`);\r\n      return res.status(400).json({ valid: false, error: \"Invalid token\" });\r\n    }\r\n\r\n    if (resetTokenRecord.expiration < new Date()) {\r\n      console.warn(`❌ Token expired: ${token}`);\r\n      await prisma.passwordResetToken.delete({\r\n        where: { id: resetTokenRecord.id },\r\n      });\r\n      return res.status(400).json({ valid: false, error: \"Token expired\" });\r\n    }\r\n\r\n    return res.status(200).json({\r\n      valid: true,\r\n      email: resetTokenRecord.email,\r\n    });\r\n  } catch (error) {\r\n    console.error(\"❌ Error verifying reset token:\", error);\r\n    return res.status(500).json({ error: \"Internal server error\" });\r\n  }\r\n}\r\n\r\n/**\r\n * DELETE /api/tokens/reset/:token\r\n * Delete a password reset token by token\r\n */\r\nexport async function deleteResetToken(req: Request, res: Response) {\r\n  try {\r\n    const { token } = req.params;\r\n\r\n    if (!token) {\r\n      console.warn(\"❌ Delete reset token: Missing token\");\r\n      return res.status(400).json({ error: \"Token is required\" });\r\n    }\r\n\r\n    // Find the token record\r\n    const resetTokenRecord = await prisma.passwordResetToken.findUnique({\r\n      where: { token },\r\n    });\r\n\r\n    if (!resetTokenRecord) {\r\n      console.warn(`❌ Reset token not found: ${token}`);\r\n      return res.status(404).json({ error: \"Token not found\" });\r\n    }\r\n\r\n    // Delete the token\r\n    await prisma.passwordResetToken.delete({\r\n      where: { id: resetTokenRecord.id },\r\n    });\r\n\r\n    return res.status(200).json({\r\n      success: true,\r\n      message: \"Token deleted successfully\",\r\n    });\r\n  } catch (error) {\r\n    console.error(\"❌ Error deleting reset token:\", error);\r\n    return res.status(500).json({ error: \"Internal server error\" });\r\n  }\r\n}\r\n"],"names":[],"mappings":"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","debug_id":"94ddb610-56b2-5f98-a836-a5a38f2b55c7"}