{"version":3,"file":"errorMiddleware.js","sources":["src/middleware/errorMiddleware.ts"],"sourceRoot":"/","sourcesContent":["import type { Request, Response, NextFunction } from \"express\";\r\n\r\n// Error handling middleware\r\nexport function routeErrorHandler(error: unknown, message?: string): void {\r\n  if (message) {\r\n    console.error(message);\r\n  }\r\n  if (error instanceof Error) {\r\n    console.error(error.stack || error.message);\r\n  } else {\r\n    console.error(error);\r\n  }\r\n}\r\n\r\nexport function errorHandler(\r\n  err: unknown,\r\n  req: Request,\r\n  res: Response,\r\n  next: NextFunction\r\n) {\r\n  // Log error\r\n  if (err instanceof Error) {\r\n    console.error(err.stack || err.message);\r\n  } else {\r\n    console.error(err);\r\n  }\r\n  // Respond with error\r\n  res.status(500).json({\r\n    success: false,\r\n    error: err instanceof Error ? err.message : String(err),\r\n    message: \"Internal server error\",\r\n  });\r\n}\r\n\r\n// 404 handler\r\nexport const notFoundHandler = (req: Request, res: Response) => {\r\n  res.status(404).json({\r\n    success: false,\r\n    error: \"Route not found\",\r\n    message: `Cannot ${req.method} ${req.path}`,\r\n    availableRoutes: {\r\n      users: {\r\n        \"GET /api/users\": \"Get all users\",\r\n        \"GET /api/users/:id\": \"Get user by ID\",\r\n        \"POST /api/users\": \"Create new user\",\r\n        \"PUT /api/users/:id\": \"Update user\",\r\n        \"DELETE /api/users/:id\": \"Delete user\",\r\n      },\r\n      posts: {\r\n        \"GET /api/posts\": \"Get all posts\",\r\n        \"GET /api/posts/:id\": \"Get post by ID\",\r\n        \"GET /api/posts/author/:authorId\": \"Get posts by author\",\r\n        \"POST /api/posts\": \"Create new post\",\r\n        \"PUT /api/posts/:id\": \"Update post\",\r\n        \"DELETE /api/posts/:id\": \"Delete post\",\r\n        \"PATCH /api/posts/:id/toggle-published\": \"Toggle post published status\",\r\n      },\r\n    },\r\n  });\r\n};\r\n\r\n// Request validation middleware\r\nexport const validateJsonMiddleware = (\r\n  error: Error,\r\n  req: Request,\r\n  res: Response,\r\n  next: NextFunction\r\n) => {\r\n  if (error instanceof SyntaxError && \"body\" in error) {\r\n    return res.status(400).json({\r\n      success: false,\r\n      error: \"Invalid JSON in request body\",\r\n      message: \"Please check your request body format\",\r\n    });\r\n  }\r\n  next(error);\r\n};\r\n"],"names":[],"mappings":"AAEA,4BAA4B;;;AAC5B,MAAM,UAAU,iBAAiB,CAAC,KAAc,EAAE,OAAgB;IAChE,IAAI,OAAO,EAAE,CAAC;QACZ,OAAO,CAAC,KAAK,CAAC,OAAO,CAAC,CAAC;IACzB,CAAC;IACD,IAAI,KAAK,YAAY,KAAK,EAAE,CAAC;QAC3B,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,KAAK,IAAI,KAAK,CAAC,OAAO,CAAC,CAAC;IAC9C,CAAC;SAAM,CAAC;QACN,OAAO,CAAC,KAAK,CAAC,KAAK,CAAC,CAAC;IACvB,CAAC;AACH,CAAC;AAED,MAAM,UAAU,YAAY,CAC1B,GAAY,EACZ,GAAY,EACZ,GAAa,EACb,IAAkB;IAElB,YAAY;IACZ,IAAI,GAAG,YAAY,KAAK,EAAE,CAAC;QACzB,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,KAAK,IAAI,GAAG,CAAC,OAAO,CAAC,CAAC;IAC1C,CAAC;SAAM,CAAC;QACN,OAAO,CAAC,KAAK,CAAC,GAAG,CAAC,CAAC;IACrB,CAAC;IACD,qBAAqB;IACrB,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;QACnB,OAAO,EAAE,KAAK;QACd,KAAK,EAAE,GAAG,YAAY,KAAK,CAAC,CAAC,CAAC,GAAG,CAAC,OAAO,CAAC,CAAC,CAAC,MAAM,CAAC,GAAG,CAAC;QACvD,OAAO,EAAE,uBAAuB;KACjC,CAAC,CAAC;AACL,CAAC;AAED,cAAc;AACd,MAAM,CAAC,MAAM,eAAe,GAAG,CAAC,GAAY,EAAE,GAAa,EAAE,EAAE;IAC7D,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;QACnB,OAAO,EAAE,KAAK;QACd,KAAK,EAAE,iBAAiB;QACxB,OAAO,EAAE,UAAU,GAAG,CAAC,MAAM,IAAI,GAAG,CAAC,IAAI,EAAE;QAC3C,eAAe,EAAE;YACf,KAAK,EAAE;gBACL,gBAAgB,EAAE,eAAe;gBACjC,oBAAoB,EAAE,gBAAgB;gBACtC,iBAAiB,EAAE,iBAAiB;gBACpC,oBAAoB,EAAE,aAAa;gBACnC,uBAAuB,EAAE,aAAa;aACvC;YACD,KAAK,EAAE;gBACL,gBAAgB,EAAE,eAAe;gBACjC,oBAAoB,EAAE,gBAAgB;gBACtC,iCAAiC,EAAE,qBAAqB;gBACxD,iBAAiB,EAAE,iBAAiB;gBACpC,oBAAoB,EAAE,aAAa;gBACnC,uBAAuB,EAAE,aAAa;gBACtC,uCAAuC,EAAE,8BAA8B;aACxE;SACF;KACF,CAAC,CAAC;AACL,CAAC,CAAC;AAEF,gCAAgC;AAChC,MAAM,CAAC,MAAM,sBAAsB,GAAG,CACpC,KAAY,EACZ,GAAY,EACZ,GAAa,EACb,IAAkB,EAClB,EAAE;IACF,IAAI,KAAK,YAAY,WAAW,IAAI,MAAM,IAAI,KAAK,EAAE,CAAC;QACpD,OAAO,GAAG,CAAC,MAAM,CAAC,GAAG,CAAC,CAAC,IAAI,CAAC;YAC1B,OAAO,EAAE,KAAK;YACd,KAAK,EAAE,8BAA8B;YACrC,OAAO,EAAE,uCAAuC;SACjD,CAAC,CAAC;IACL,CAAC;IACD,IAAI,CAAC,KAAK,CAAC,CAAC;AACd,CAAC,CAAC","debug_id":"3508ff21-3472-5fdb-a013-0ccdb82a55eb"}